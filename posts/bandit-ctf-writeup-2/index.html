<!DOCTYPE html>
<html lang="en-us">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<meta name="theme-color" content="#494f5c">
	<meta name="msapplication-TileColor" content="#494f5c">
	
	<script type="text/javascript">
		partytown = {
			forward: ['dataLayer.push']
		};
	</script>
	<script type="text/javascript">
		(()=>{!function(e,t,n,s,o,i,a,r,c,l,d,u){function h(){u||(u=1,"/"==(a=(i.lib||"/~partytown/")+(i.debug?"debug/":""))[0]&&(c=t.querySelectorAll('script[type="text/partytown"]'),s!=e?s.dispatchEvent(new CustomEvent("pt1",{detail:e})):(r=setTimeout(f,1e4),t.addEventListener("pt0",p),o?m(1):n.serviceWorker?n.serviceWorker.register(a+(i.swPath||"partytown-sw.js"),{scope:a}).then(function(e){e.active?m():e.installing&&e.installing.addEventListener("statechange",function(e){"activated"==e.target.state&&m()})},console.error):f())))}function m(e){l=t.createElement(e?"script":"iframe"),e||(l.setAttribute("style","display:block;width:0;height:0;border:0;visibility:hidden"),l.setAttribute("aria-hidden",!0)),l.src=a+"partytown-"+(e?"atomics.js?v=0.8.0":"sandbox-sw.html?"+Date.now()),t.querySelector(i.sandboxParent||"body").appendChild(l)}function f(n,o){for(p(),s==e&&(i.forward||[]).map(function(t){delete e[t.split(".")[0]]}),n=0;n<c.length;n++)(o=t.createElement("script")).innerHTML=c[n].innerHTML,t.head.appendChild(o);l&&l.parentNode.removeChild(l)}function p(){clearTimeout(r)}i=e.partytown||{},s==e&&(i.forward||[]).map(function(t){d=e,t.split(".").map(function(t,n,s){d=d[s[n]]=n+1<s.length?"push"==s[n+1]?[]:d[s[n]]||{}:function(){(e._ptf=e._ptf||[]).push(s,arguments)}})}),"complete"==t.readyState?h():(e.addEventListener("DOMContentLoaded",h),e.addEventListener("load",h))}(window,document,navigator,top,window.crossOriginIsolated)})()
	</script>
	
<meta itemprop="name" content="OTW Bandit CTF üö© Writeup - Part 2 - Levels 13 to 22">
<meta itemprop="description" content="See all the bandit writeups for the other levels.
Coffee? ‚úÖ
Workout? ‚úÖ
Laptops? ‚úÖ
Then let&rsquo;s goooooo
SPOILER ALERT Level 13 -&gt; Level 14 Level 14 -&gt; Level 15 Level 15 -&gt; Level 16 Level 16 -&gt; Level 17 Level 17 -&gt; Level 18 Level 18 -&gt; Level 19 Level 19 -&gt; Level 20 Level 20 -&gt; Level 21 Level 21 -&gt; Level 22 Level 22 and beyond SPOILER ALERT THIS WRITEUP WILL SPOIL THE CHALLENGE FOR YOU."><meta itemprop="datePublished" content="2020-02-15T21:57:03+02:00" />
<meta itemprop="dateModified" content="2020-02-15T21:57:03+02:00" />
<meta itemprop="wordCount" content="1173">
<meta itemprop="keywords" content="linux,ctf,writeups,bandit,overthewire," /><meta property="og:title" content="OTW Bandit CTF üö© Writeup - Part 2 - Levels 13 to 22" />
<meta property="og:description" content="See all the bandit writeups for the other levels.
Coffee? ‚úÖ
Workout? ‚úÖ
Laptops? ‚úÖ
Then let&rsquo;s goooooo
SPOILER ALERT Level 13 -&gt; Level 14 Level 14 -&gt; Level 15 Level 15 -&gt; Level 16 Level 16 -&gt; Level 17 Level 17 -&gt; Level 18 Level 18 -&gt; Level 19 Level 19 -&gt; Level 20 Level 20 -&gt; Level 21 Level 21 -&gt; Level 22 Level 22 and beyond SPOILER ALERT THIS WRITEUP WILL SPOIL THE CHALLENGE FOR YOU." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.mrnice.dev/posts/bandit-ctf-writeup-2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-02-15T21:57:03+02:00" />
<meta property="article:modified_time" content="2020-02-15T21:57:03+02:00" />


<meta name="twitter:title" content="OTW Bandit CTF üö© Writeup - Part 2 - Levels 13 to 22">


<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@ShayNehmad">
<meta name="twitter:image" content="https://i.imgur.com/ROzkHYp.png">

<meta name="twitter:creator" content="@ShayNehmad">



<meta
	name="description"
	content="See all the bandit writeups for the other levels.
Coffee? ‚úÖ
Workout? ‚úÖ
Laptops? ‚úÖ
Then let&rsquo;s goooooo
SPOILER ALERT Level 13 -&gt; Level 14 Level 14 -&gt; Level 15 Level 15 -&gt; Level 16 Level 16 -&gt; Level 17 Level 17 -&gt; Level 18 Level 18 -&gt; Level 19 Level 19 -&gt; Level 20 Level 20 -&gt; Level 21 Level 21 -&gt; Level 22 Level 22 and beyond SPOILER ALERT THIS WRITEUP WILL SPOIL THE CHALLENGE FOR YOU."
/>
<script type="application/ld+json">
	{
		"@context": "https://schema.org",
		"@type": "Organization",
		"url": "https://www.mrnice.dev/",
		"logo": "https://www.mrnice.dev/images/site-logo.png"
	}
</script>
	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
	<link rel="shortcut icon" href="/favicon.ico">

	<title>OTW Bandit CTF üö© Writeup - Part 2 - Levels 13 to 22</title>
	<link rel="stylesheet" href="https://www.mrnice.dev/css/style.min.1370d543e7fc066541fe61534a202498c057ea3b7a39dfd2ad3f444a2dadaa87.css" integrity="sha256-E3DVQ+f8BmVB/mFTSiAkmMBX6jt6Od/SrT9ESi2tqoc=" crossorigin="anonymous">
	
	

	<link rel="stylesheet" href="https://cdn.rawgit.com/Killercodes/281792c423a4fe5544d9a8d36a4430f2/raw/36c2eb3e0c44133880485a143717bda9d180f2c1/GistDarkCode.css" media="print" onload="this.media='all'">
</head>

<body id="page">
	
	<header id="site-header" class="animated slideInUp">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left">
				<div class="site-branding">
					<a href="https://www.mrnice.dev/">mrnice.dev</a>
				</div>
				<nav class="site-nav hide-in-mobile">
					
				<a href="https://www.mrnice.dev/posts/">Posts üìñ</a>
				<a href="https://www.mrnice.dev/about/">About me üßî</a>
				<a href="https://www.mrnice.dev/ctf/">git CTF üö©</a>

				</nav>
			</div>
			<div class="hdr-right hdr-icons">
				<span class="hdr-social hide-in-mobile"><a href="https://twitter.com/ShayNehmad" target="_blank" rel="noopener me" title="Twitter"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg></a><a href="mailto:hello@shaynehmad.com" target="_blank" rel="noopener me" title="Email"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg></a><a href="https://www.linkedin.com/in/shay-nehmad/" target="_blank" rel="noopener me" title="Linkedin"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg></a><a href="https://stackoverflow.com/users/4119906/shay-nehmad" target="_blank" rel="noopener me" title="Stackoverflow"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2.913 16.041v6.848h17.599v-6.848M7.16 18.696h8.925M7.65 13.937l8.675 1.8M9.214 9.124l8.058 3.758M12.086 4.65l6.849 5.66M15.774 1.111l5.313 7.162"/></svg></a><a href="https://github.com/TheCoreMan" target="_blank" rel="noopener me" title="Github"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a></span><button id="menu-btn" class="hdr-btn" title="Menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast">
		<ul>
			<li><a href="https://www.mrnice.dev/posts/">Posts üìñ</a></li>
			<li><a href="https://www.mrnice.dev/about/">About me üßî</a></li>
			<li><a href="https://www.mrnice.dev/ctf/">git CTF üö©</a></li>
		</ul>
	</div>


	<main class="site-main section-inner animated fadeIn faster">
		<article class="thin">
			<header class="post-header">
				<div class="post-meta"><span>Feb 15, 2020</span></div>
				<h1>OTW Bandit CTF üö© Writeup - Part 2 - Levels 13 to 22</h1>
			</header>
			<div class="content">
				<p><strong>See <a href="https://www.mrnice.dev/tags/bandit/">all the bandit writeups</a> for the other levels.</strong></p>
<p>Coffee? ‚úÖ</p>
<p>Workout? ‚úÖ</p>
<p>Laptops? ‚úÖ</p>
<p><img src="https://i.imgur.com/E0CJvNO.jpg" alt="workstation"></p>
<p>Then let&rsquo;s goooooo</p>
<p><img src="https://i1.sndcdn.com/artworks-000524575062-dx085e-t500x500.jpg" alt="here we go again"></p>
<ul>
<li><a href="#spoiler-alert">SPOILER ALERT</a></li>
<li><a href="#level-13---level-14">Level 13 -&gt; Level 14</a></li>
<li><a href="#level-14---level-15">Level 14 -&gt; Level 15</a></li>
<li><a href="#level-15---level-16">Level 15 -&gt; Level 16</a></li>
<li><a href="#level-16---level-17">Level 16 -&gt; Level 17</a></li>
<li><a href="#level-17---level-18">Level 17 -&gt; Level 18</a></li>
<li><a href="#level-18---level-19">Level 18 -&gt; Level 19</a></li>
<li><a href="#level-19---level-20">Level 19 -&gt; Level 20</a></li>
<li><a href="#level-20---level-21">Level 20 -&gt; Level 21</a></li>
<li><a href="#level-21---level-22">Level 21 -&gt; Level 22</a></li>
<li><a href="#level-22-and-beyond">Level 22 and beyond</a></li>
</ul>
<h2 id="spoiler-alert">SPOILER ALERT<a href="#spoiler-alert" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p><strong>THIS WRITEUP WILL SPOIL THE CHALLENGE FOR YOU</strong>.</p>
<p>So why am I writing it up?</p>
<ol>
<li>I want to be sure that I understood how I solved the level.</li>
<li>I want to be sure that I can explain my solution to other people.</li>
<li>If someone is stuck and wants some help to continue, they can do so quickly.</li>
</ol>
<p>These challeges can be frustrating. While I think that a little frustration is good (especially in CTFs), I hope this guide will cause someone who was almost discouraged from trying/continuing the challenge to carry on. If you&rsquo;re one of these people - don&rsquo;t give up! You can do this üí™üèΩ</p>
<p><img src="https://previews.123rf.com/images/lkeskinen/lkeskinen1705/lkeskinen170506216/78174196-spoiler-alert-rubber-stamp.jpg" alt="spoiler alert"></p>
<p>Also, I will try to avoid posting the passwords. If you do see a password that I forgot to omit please let me know!</p>
<h2 id="level-13---level-14">Level 13 -&gt; Level 14<a href="#level-13---level-14" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>The first thing you see is a file called <code>sshkey.private</code> and the contents are these:</p>
<p><img src="https://i.imgur.com/iE95Wze.png" alt="ssh key"></p>
<p>After reading a little about how SSH works, the gist for this challenge is that if you have someone&rsquo;s <em>private</em> key (in this case, <code>bandit14</code>&rsquo;s private key file), you can login as him if the server has authorized his <em>public</em> key. So, now let&rsquo;s get to business: a quick <code>man ssh</code> and then search for the word private by writing <code>/private</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">    -i identity_file
</span></span><span class="line"><span class="cl">      Selects a file from which the identity <span class="o">(</span>private key<span class="o">)</span> <span class="k">for</span> public key authentication is read.
</span></span></code></pre></div><p>Finally, let&rsquo;s log in (Shoutout to <a href="https://www.screentogif.com/">ScreenToGif</a>):</p>
<p><img src="https://media.giphy.com/media/efy5gRS8LbOXlihvFB/giphy.gif" alt="bandit13solve"></p>
<h2 id="level-14---level-15">Level 14 -&gt; Level 15<a href="#level-14---level-15" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>The level guide tells us the following: <code>The password for the next level can be retrieved by submitting the password of the current level to port 30000 on localhost.</code>.</p>
<p>Let&rsquo;s first make sure someone is indeed listening and in which protocol, using <code>nmap</code>:</p>
<p><img src="https://i.imgur.com/WO9a6tT.png" alt="nmap result"></p>
<p>We see <code>30000/tcp</code> which is good. It means that there&rsquo;s a server listening on port <code>30000</code> with the <code>TCP</code> protocol. We don&rsquo;t know what the server is really expecting, so let&rsquo;s try to talk to it and see what happens. We can use the <code>nc</code> command to do that. Again, the example is straight out of the <code>man nc</code> page:</p>
<p><img src="https://i.imgur.com/jIdevK5.png" alt="nc wrong password"></p>
<p>OK! So we have a server that&rsquo;s listening for text-based input listening on port 30000/tcp and we need to submit the user&rsquo;s current password to the server. I admit I was stuck on this for a while until my wife reminded me the previous instructions we got which told us that the password was stored in <code>/etc/bandit_pass/bandit14</code> üòÖ So, to solve this we needed to pass the contents of that file to the server:</p>
<p><img src="https://i.imgur.com/7R09eL9.png" alt="nc right passowrd"></p>
<h2 id="level-15---level-16">Level 15 -&gt; Level 16<a href="#level-15---level-16" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>This level is very similar to the previous one, but you need to connect using SSL. Luckily, <code>openssl</code> has a handy utility just for that: <code>s_client</code>. Just run <code>openssl s_client -connect localhost:30001</code> and paste the password and you&rsquo;re good!</p>
<h2 id="level-16---level-17">Level 16 -&gt; Level 17<a href="#level-16---level-17" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>We need to find a specific server that&rsquo;s listening on TLS between ports 31000 and 32000. Just running <code>nmap localhost</code> won&rsquo;t do because <code>nmap</code> only scans some known ports and not the range we need. So we&rsquo;ll have to use the <code>-p</code> flag to specify ports:</p>
<p><img src="https://i.imgur.com/UX3jk73.png" alt="nmap"></p>
<p>We got 2 servers. Let&rsquo;s try to connect to them using SSL, just like the last stage: <code>openssl s_client -connect localhost:31518</code>. One of them only echoes what we send it, but the second one gives us a private key when we provide the password! All we need to do is copy the private key from the shell, exit the SSH session, create a local file on our computer (I called it <code>bandit17.sshkey</code>), paste our key into it, and login!</p>
<p>Oh wait&hellip;</p>
<p><img src="https://i.imgur.com/XoStDS2.png" alt="ssh bad permissions"></p>
<p>The <code>ssh</code> client chosses to ignores private key files which are too overly permissive. This is due to security concerns. We need to change the permissions to be only readable by us, or to <code>400</code>, using <code>chmod</code>.</p>
<p><img src="https://i.imgur.com/W7PGXaX.png" alt="bandit 16 win"></p>
<h2 id="level-17---level-18">Level 17 -&gt; Level 18<a href="#level-17---level-18" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">diff passwords.old passwords.new
</span></span></code></pre></div><p>Nothing to write up about, really :)</p>
<h2 id="level-18---level-19">Level 18 -&gt; Level 19<a href="#level-18---level-19" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>After logging in we get logged right out!</p>
<p><img src="https://i.imgur.com/X44zwp6.png" alt="bashrc nonsense"></p>
<p>This is because of a modified <code>.bashrc</code> file which prints &ldquo;Bye Bye&rdquo; and kills the shell. We can&rsquo;t read the files from the previous user (<code>bandit18</code>) since we don&rsquo;t have permissions to do so. And <code>bash</code> opens up automatically since it&rsquo;s the <a href="https://unix.stackexchange.com/questions/38175/difference-between-login-shell-and-non-login-shell">login shell</a>.</p>
<p>However, instead of running an interactive session and therefore opening up the login shell, we can run a command directly from <code>ssh</code>:</p>
<p><img src="https://i.imgur.com/VPotd1a.png" alt="echo hello over ssh"></p>
<p>So to win this stage, all we need to do is:</p>
<p><img src="https://i.imgur.com/jI4hDsh.png" alt="win bandit18"></p>
<h2 id="level-19---level-20">Level 19 -&gt; Level 20<a href="#level-19---level-20" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>In this level we are presented with a <strong>suid</strong> binary. This is quite a difficult concept so let&rsquo;s make sure we understand it. First off you need to understand Unix permissions. Luckily, <a href="https://twitter.com/b0rk">@b0rk</a> explains it in a very simple way:</p>
<p><a href="https://twitter.com/b0rk/status/982641594305273856"><img src="https://pbs.twimg.com/media/DaMLUoGXUAI21V6?format=jpg&amp;name=large" alt="unix permission by @b0rk"></a></p>
<p>See that last panel? That&rsquo;s the key for this stage. Let&rsquo;s run <code>ls -l</code> and see what we get.</p>
<p><img src="https://i.imgur.com/MKcsr8O.png" alt="ls -l bandit 19"></p>
<p>And let&rsquo;s break it down according to what we&rsquo;ve learned about permissions:</p>
<ul>
<li><code>-rwsr-x---</code> This is divided into three parts:
<ul>
<li><code>rws</code> means that the <em>user</em> can read, write and suid - execute and change the EUID during execution to the <em>user</em> as well. In case you missed it, EUID (which stands for Effective User ID) is what is actually checked when the Operating System checks a process for permissions.</li>
<li><code>r-x</code> means that the <em>group</em> can read and execute the file.</li>
<li><code>---</code> means that <em>everyone</em> don&rsquo;t have any access to this file.</li>
</ul>
</li>
<li><code>bandit20 bandit19</code> - These are, in order, the <em>user</em> and the <em>group</em>.</li>
</ul>
<p>Seems like we should have execution rights. Let&rsquo;s run the file and see what we get!</p>
<p><img src="https://i.imgur.com/UXVvbxP.png" alt="run the suid"></p>
<p>The SUID binary changed the EUID to <code>bandit20</code>, and then ran whichever command we told it to run. So let&rsquo;s read the password file as <code>bandit20</code>.</p>
<p><img src="https://i.imgur.com/ykvSOJ9.png" alt="win bandit19"></p>
<h2 id="level-20---level-21">Level 20 -&gt; Level 21<a href="#level-20---level-21" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>This level combines a lot of our knowledge from previous stages. We need to set up a server which will listen on a port of our choosing and then use the SUID binary to connect to it. We can use <code>nc -l -p 5656</code> (<code>-l</code> means listen and <code>-p 5656</code> indicates which port we chose), like so:</p>
<p><img src="https://media.giphy.com/media/iGM1EWLyCtj1wj0l7k/giphy.gif" alt="Set up the server"></p>
<p>Then, instead of transmitting &ldquo;hello&rdquo;, we will transmit the current password.</p>
<p><img src="https://i.imgur.com/AhUA28S.png" alt="win bandit 20"></p>
<h2 id="level-21---level-22">Level 21 -&gt; Level 22<a href="#level-21---level-22" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>In this level we learn about <code>cron</code> and the <code>crontab</code> files. So read about those <a href="https://linux.die.net/man/5/crontab">here</a> and then the level becomes quite easy.</p>
<p>The <code>cronjob_bandit22</code> runs the <code>/usr/bin/cronjob_bandit22.sh</code> script every minute and after reboot as well. The script just saves the password in a temporary file and gives read permissions to everyone, so we read it and win!</p>
<p><img src="https://i.imgur.com/OFOKQ9M.png" alt="crontab level"></p>
<h2 id="level-22-and-beyond">Level 22 and beyond<a href="#level-22-and-beyond" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>Well, we haven&rsquo;t solved them yet. We&rsquo;re going to sleep üò¥ Be on the lookout for part 3!</p>

			</div>

<div class="related-posts thin">
	<h2>See Also</h2>
	<ul>
	
	<li><a href="/posts/bandit-ctf-writeup/">OTW Bandit CTF üö© Writeup - Part 1 - Levels 0 to 13</a></li>
	
	<li><a href="/posts/what-to-pack-for-a-deserted-linux-island/">What to Pack for a Deserted Linux Island</a></li>
	
	</ul>
</div>

			<hr class="post-end">
			<footer class="post-info">
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-feather"><path d="M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z"></path><line x1="16" y1="8" x2="2" y2="22"></line><line x1="17.5" y1="15" x2="9" y2="15"></line></svg>Shay Nehmad</p>
				<p>
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://www.mrnice.dev/tags/linux">linux</a></span><span class="tag"><a href="https://www.mrnice.dev/tags/ctf">ctf</a></span><span class="tag"><a href="https://www.mrnice.dev/tags/writeups">writeups</a></span><span class="tag"><a href="https://www.mrnice.dev/tags/bandit">bandit</a></span><span class="tag"><a href="https://www.mrnice.dev/tags/overthewire">overthewire</a></span>
				</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>1173 Words</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2020-02-15 21:57 &#43;0200</p>
			</footer>
		</article>
		<div class="post-nav thin">
			<a class="next-post" href="https://www.mrnice.dev/posts/monkey-see-centra-do-1/">
				<span class="post-nav-label"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>&nbsp;Newer</span><br><span>Monkey See, Centra do: How to Assess Your Zero Trust Status and Mitigate</span>
			</a>
			<a class="prev-post" href="https://www.mrnice.dev/posts/bandit-ctf-writeup/">
				<span class="post-nav-label">Older&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg></span><br><span>OTW Bandit CTF üö© Writeup - Part 1 - Levels 0 to 13</span>
			</a>
		</div>
		<div id="comments" class="thin">
</div>
	</main>

	<footer id="site-footer" class="section-inner thin animated fadeIn faster">
		<p>&copy; 2024 <a href="https://www.mrnice.dev/"></a></p>
		<p>
			Made with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a>
			&#183; <a href="https://www.mrnice.dev/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a>
			&#183; <a href="https://mrnicedev.onlineornot.com/" title="Status" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linejoin="round" class="feather"><rect width="24" height="24" opacity="0"/><path d="M9.71 11.29a1 1 0 0 0-1.42 1.42l3 3A1 1 0 0 0 12 16a1 1 0 0 0 .72-.34l7-8a1 1 0 0 0-1.5-1.32L12 13.54z"/><path d="M21 11a1 1 0 0 0-1 1 8 8 0 0 1-8 8A8 8 0 0 1 6.33 6.36 7.93 7.93 0 0 1 12 4a8.79 8.79 0 0 1 1.9.22 1 1 0 1 0 .47-1.94A10.54 10.54 0 0 0 12 2a10 10 0 0 0-7 17.09A9.93 9.93 0 0 0 12 22a10 10 0 0 0 10-10 1 1 0 0 0-1-1z"/></svg></a>
		</p>
	</footer>



	<script src="https://www.mrnice.dev/js/bundle.min.580988ed2982bcbb74a1773c7abea97b43e4c43b9324e10cda0813ec6ec4bb67.js" integrity="sha256-WAmI7SmCvLt0oXc8er6pe0PkxDuTJOEM2ggT7G7Eu2c=" crossorigin="anonymous"></script>
	
<script
	async
	src="https://www.googletagmanager.com/gtag/js?id=G-FG2CEVRBFP"
	type="text/partytown"
></script>
<script type="text/partytown">
	var doNotTrack = false;
	if (!doNotTrack) {
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());
		gtag('config', 'G-FG2CEVRBFP', { 'anonymize_ip':false});
	}
</script>

</body>

</html>
